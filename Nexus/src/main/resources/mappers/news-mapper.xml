<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="newsMapper">

	<resultMap type="News" id="newsResultSet">
		<result column="news_no" property="newsNo"/>
		<result column="user_name" property="userNo"/>
		<result column="news_title" property="newsTitle"/>
		<result column="news_content" property="newsContent"/>
		<result column="CREATE_DATE" property="createDate"/>
		<result column="thumbnail" property="thumbnail"/>
		<result column="profile" property="profile"/>
	</resultMap>
	
	<resultMap type="NewsReply" id="newsReplyResultSet">
		<result column="news_no" property="newsNo"/>
		<result column="user_name" property="commentWriter"/>
		<result column="comment_content" property="commentContent"/>
		<result column="comment_date" property="commentDate"/>
		<result column="status" property="status"/>
		<result column="profile" property="profile"/>
	</resultMap>
	
	<select id="selectList" resultMap="newsResultSet">
		select * from(
			select
			         news_no
			       , user_name 
			       , news_title
			       , news_content
			       , to_char(create_date,'YYYY-MM-DD') "CREATE_DATE"
			       , thumbnail
			       , profile
			 from tb_news n
			 join tb_member using(user_no)
			 where n.status='Y'
			 order by news_no desc)
			 where rownum BETWEEN 1 and 12
	</select>
	
	<select id="ajaxSelectList" resultMap="newsResultSet">
			select
			         news_no
			       , user_name 
			       , news_title
			       , news_content
			       , to_char(create_date,'YYYY-MM-DD') "CREATE_DATE"
			       , change_name
			       , profile
			 from tb_news n
			 join tb_member using(user_no)
			 where n.status='Y'
			 order by news_no desc
			 
	</select>
	
	<select id="selectrList" resultMap="newsReplyResultSet">
		select 
		        news_no
		      , user_name
		      , comment_content
		      , to_char(comment_date,'YYYY.MM.DD HH24:MI:SS') "COMMENT_DATE"
		      , profile
		from tb_news_comments  nc
		join tb_member on(user_no = comment_writer)
		where nc.status = 'Y'
        and news_no = #{newsNo}
        order by comment_date asc
	</select>
	
	<insert id="newsReplyInsert">
		insert 
			into tb_news_comments
			(
				news_no
			  , comment_writer
			  , comment_content
			)
			values
			(
				#{newsNo}
			  , #{commentWriter}
			  , #{commentContent}
			)
	</insert>
	
	<insert id="insertNews">
		insert
		  into tb_news
		  (
		     news_no
		   , user_no
		   , news_title
		   , news_content
		   , thumbnail
		  )
		  values
		  (
		     seq_news.nextval
		   , #{userNo}
		   , #{newsTitle}
		   , #{newsContent}
		   , #{thumbnail}
		  )
	</insert>
	
	<select id="seletNews" resultMap="newsResultSet">
		select 
		         news_no
		       , user_name
		       , news_title
		       , news_content
		       , create_date
		  from tb_news n
		  join tb_member using(user_no)
		  where n.status = 'Y'
		  and news_no =#{nNo}
	</select>
	
	
</mapper>